<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>チャートテスト</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .chart-container { width: 400px; height: 300px; margin: 20px; }
    </style>
</head>
<body>
    <h1>チャートテスト</h1>

    <div class="chart-container">
        <h3>レーダーチャート（ビタミン・ミネラル）</h3>
        <canvas id="testRadarChart"></canvas>
    </div>

    <div class="chart-container">
        <h3>バーチャート（日次摂取基準）</h3>
        <canvas id="testBarChart"></canvas>
    </div>

    <div class="chart-container">
        <h3>ドーナツチャート（PFCバランス）</h3>
        <canvas id="testDoughnutChart"></canvas>
    </div>

    <script>
        // テストデータ
        const testMenu = {
            name: "プロテインシーザーサラダ（チキン）",
            nutrition: {
                calories: 285,
                protein: 32.5,
                carbs: 8.2,
                fat: 12.8,
                vitamin_a: 850,
                vitamin_c: 25,
                vitamin_e: 8.5,
                calcium: 180,
                iron: 2.8,
                magnesium: 85,
                zinc: 3.2
            }
        };

        // レーダーチャート
        const radarCtx = document.getElementById('testRadarChart').getContext('2d');
        new Chart(radarCtx, {
            type: 'radar',
            data: {
                labels: ['ビタミンA', 'ビタミンC', 'ビタミンE', 'カルシウム', '鉄', 'マグネシウム', '亜鉛'],
                datasets: [{
                    label: '栄養素含有量（%DV）',
                    data: [
                        (testMenu.nutrition.vitamin_a / 900 * 100),
                        (testMenu.nutrition.vitamin_c / 100 * 100),
                        (testMenu.nutrition.vitamin_e / 6.5 * 100),
                        (testMenu.nutrition.calcium / 750 * 100),
                        (testMenu.nutrition.iron / 7.5 * 100),
                        (testMenu.nutrition.magnesium / 370 * 100),
                        (testMenu.nutrition.zinc / 11 * 100)
                    ],
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                scales: {
                    r: {
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            stepSize: 20,
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                }
            }
        });

        // バーチャート
        const barCtx = document.getElementById('testBarChart').getContext('2d');
        new Chart(barCtx, {
            type: 'bar',
            data: {
                labels: ['カロリー', 'タンパク質', '脂質', '炭水化物'],
                datasets: [{
                    label: '日次摂取基準に対する割合（%）',
                    data: [
                        (testMenu.nutrition.calories / 2650 * 100),
                        (testMenu.nutrition.protein / 65 * 100),
                        (testMenu.nutrition.fat / 74 * 100),
                        (testMenu.nutrition.carbs / 396 * 100)
                    ],
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.8)',
                        'rgba(54, 162, 235, 0.8)',
                        'rgba(255, 206, 86, 0.8)',
                        'rgba(75, 192, 192, 0.8)'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            callback: function(value) {
                                return value + '%';
                            }
                        }
                    }
                }
            }
        });

        // ドーナツチャート
        const doughnutCtx = document.getElementById('testDoughnutChart').getContext('2d');
        new Chart(doughnutCtx, {
            type: 'doughnut',
            data: {
                labels: ['タンパク質', '炭水化物', '脂質'],
                datasets: [{
                    data: [
                        testMenu.nutrition.protein * 4,
                        testMenu.nutrition.carbs * 4,
                        testMenu.nutrition.fat * 9
                    ],
                    backgroundColor: [
                        'rgba(54, 162, 235, 0.8)',
                        'rgba(255, 206, 86, 0.8)',
                        'rgba(255, 99, 132, 0.8)'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true
            }
        });

        console.log('All test charts created successfully');
    </script>
</body>
</html>